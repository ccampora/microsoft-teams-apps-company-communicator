(this["webpackJsonpcompany-communicator"]=this["webpackJsonpcompany-communicator"]||[]).push([[0],{427:function(e,t,a){e.exports=a(658)},432:function(e,t,a){},566:function(e,t,a){},567:function(e,t,a){},568:function(e,t,a){},634:function(e,t,a){},635:function(e,t,a){},639:function(e,t,a){},640:function(e,t,a){},641:function(e,t,a){},642:function(e,t,a){},643:function(e,t,a){},658:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(51),i=a.n(r),c=(a(432),a(34)),o=a(36),l=a(41),u=a(40),m=a(418),d=a(37),p=a(19),h=function(){return window.location.origin},g=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={url:h()+"/messages?locale={locale}"},n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;p.initialize(),p.settings.registerOnSaveHandler((function(t){p.settings.setSettings({entityId:"Company_Communicator_App",contentUrl:e.state.url,suggestedDisplayName:"Company Communicator"}),t.notifySuccess()})),p.settings.setValidityState(!0)}},{key:"render",value:function(){return s.a.createElement("div",{className:"configContainer"},s.a.createElement("h3",null,"Please click Save to get started."))}}]),a}(s.a.Component),f=a(155),v=a(669),b=a(161),E=a(67),k=a(676),C=a(677),S=a(198),w=a(72),y=a(24),x=a(91),O=a(142),T=a(15),N=a.n(T),L=a(20),z=a(221),M=a(180),j=a(384),I=a(113),A=a.n(I);a(438);z.a.use(j.a).use(M.e).init({fallbackLng:"en-US",interpolation:{escapeValue:!1}});var D=function(e){return e?A()(e).format("l LT"):e},U=function(e,t){var a="";if(e&&t){var n=A()(t).diff(A()(e)),s=A.a.duration(n);a=("0"+Math.floor(s.asHours())).slice(-2)+A.a.utc(s.asMilliseconds()).locale("en-US").format(":mm:ss")}return a},R=function(e){var t=window.location.search,a=new URLSearchParams(t).get("locale")||"en-US";return Number(e).toLocaleString(a)},B=z.a,F=a(162),G=a.n(F),P=new(function(){function e(){Object(c.a)(this,e)}return Object(o.a)(e,[{key:"get",value:function(){var e=Object(L.a)(N.a.mark((function e(t){var a,n,s,r=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!(r.length>1&&void 0!==r[1])||r[1],n=!(r.length>2&&void 0!==r[2])||r[2],s=r.length>3?r[3]:void 0,e.prev=3,!n){e.next=8;break}return e.next=7,this.setupAuthorizationHeader(s);case 7:s=e.sent;case 8:return e.next=10,G.a.get(t,s);case 10:return e.abrupt("return",e.sent);case 13:if(e.prev=13,e.t0=e.catch(3),!a){e.next=20;break}throw this.handleError(e.t0),e.t0;case 20:throw e.t0;case 21:case"end":return e.stop()}}),e,this,[[3,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(L.a)(N.a.mark((function e(t){var a,n,s=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=!(s.length>1&&void 0!==s[1])||s[1],n=s.length>2?s[2]:void 0,e.prev=2,e.next=5,this.setupAuthorizationHeader(n);case 5:return n=e.sent,e.next=8,G.a.delete(t,n);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!a){e.next=18;break}throw this.handleError(e.t0),e.t0;case 18:throw e.t0;case 19:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(L.a)(N.a.mark((function e(t,a){var n,s,r=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(r.length>2&&void 0!==r[2])||r[2],s=r.length>3?r[3]:void 0,e.prev=2,e.next=5,this.setupAuthorizationHeader(s);case 5:return s=e.sent,e.next=8,G.a.post(t,a,s);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!n){e.next=18;break}throw this.handleError(e.t0),e.t0;case 18:throw e.t0;case 19:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=Object(L.a)(N.a.mark((function e(t,a){var n,s,r=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(r.length>2&&void 0!==r[2])||r[2],s=r.length>3?r[3]:void 0,e.prev=2,e.next=5,this.setupAuthorizationHeader(s);case 5:return s=e.sent,e.next=8,G.a.put(t,a,s);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!n){e.next=18;break}throw this.handleError(e.t0),e.t0;case 18:throw e.t0;case 19:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"handleError",value:function(e){if(e.hasOwnProperty("response")){var t=e.response.status;window.location.href=403===t?"/errorpage/403?locale=".concat(B.language):401===t?"/errorpage/401?locale=".concat(B.language):"/errorpage?locale=".concat(B.language)}else window.location.href="/errorpage?locale=".concat(B.language)}},{key:"setupAuthorizationHeader",value:function(){var e=Object(L.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.initialize(),e.abrupt("return",new Promise((function(e,a){var n={successCallback:function(a){t||(t=G.a.defaults),t.headers.Authorization="Bearer ".concat(a),t.headers["Accept-Language"]=B.language,e(t)},failureCallback:function(e){console.error("Error from getAuthToken: ",e),window.location.href="/signin?locale=".concat(B.language)},resources:[]};p.authentication.getAuthToken(n)})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}()),_=h()+"/api",H=function(){var e=Object(L.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=_+"/sentnotifications",e.next=3,P.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=function(){var e=Object(L.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=_+"/draftnotifications",e.next=3,P.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Object(L.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=_+"/groupdata/verifyaccess",e.next=3,P.get(t,!1);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=function(){var e=Object(L.a)(N.a.mark((function e(t){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/groupdata/"+t,e.next=3,P.get(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(L.a)(N.a.mark((function e(t){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/groupdata/search/"+t,e.next=3,P.get(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(L.a)(N.a.mark((function e(t){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/exportnotification/export",e.next=3,P.put(a,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(L.a)(N.a.mark((function e(t){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/sentnotifications/"+t,e.next=3,P.get(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(L.a)(N.a.mark((function e(t){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/draftnotifications/"+t,e.next=3,P.get(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(L.a)(N.a.mark((function e(t){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/draftnotifications/"+t,e.next=3,P.delete(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(L.a)(N.a.mark((function e(t){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/draftnotifications/duplicates/"+t,e.next=3,P.post(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(L.a)(N.a.mark((function e(t){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/sentnotifications",e.next=3,P.post(a,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(L.a)(N.a.mark((function e(t){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/draftnotifications",e.next=3,P.put(a,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(L.a)(N.a.mark((function e(t){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/draftnotifications",e.next=3,P.post(a,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=Object(L.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=_+"/teamdata",e.next=3,P.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ne=function(){var e=Object(L.a)(N.a.mark((function e(t){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/draftnotifications/consentSummaries/"+t,e.next=3,P.get(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=function(){var e=Object(L.a)(N.a.mark((function e(t){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_+"/draftnotifications/previews",e.next=3,P.post(a,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=Object(L.a)(N.a.mark((function e(t,a){var n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(_,"/authenticationMetadata/consentUrl?windowLocationOriginDomain=").concat(t,"&loginhint=").concat(a),e.next=3,P.get(n,void 0,!1);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ie=function(e){return{type:"MESSAGE_SELECTED",payload:e}},ce=function(){return function(){var e=Object(L.a)(N.a.mark((function e(t){var a,n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H();case 2:a=e.sent,(n=a.data).forEach((function(e){e.sendingStartedDate=D(e.sendingStartedDate),e.sentDate=D(e.sentDate)})),t({type:"FETCH_MESSAGES",payload:n});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},oe=function(){return function(){var e=Object(L.a)(N.a.mark((function e(t){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q();case 2:a=e.sent,t({type:"FETCH_DRAFTMESSAGES",payload:a.data});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},le=a(79),ue=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).localize=void 0,n.onOpenTaskModule=function(e,t,a){var n={url:t,title:a,height:530,width:1e3,fallbackUrl:t};p.tasks.startTask(n,(function(e,t){}))},n.duplicateDraftMessage=function(){var e=Object(L.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Y(t);case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),n.localize=n.props.t,n.state={menuOpen:!1},n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){p.initialize()}},{key:"render",value:function(){var e=this,t=[{key:"more",icon:{name:"more",outline:!0},menuOpen:this.state.menuOpen,active:this.state.menuOpen,indicator:!1,menu:{items:[{key:"status",content:this.localize("ViewStatus"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1});var a=h()+"/viewstatus/"+e.props.message.id+"?locale={locale}";e.onOpenTaskModule(null,a,e.localize("ViewStatus"))}},{key:"duplicate",content:this.localize("Duplicate"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1}),e.duplicateDraftMessage(e.props.message.id).then((function(){e.props.getDraftMessagesList()}))}}]},onMenuOpenChange:function(t,a){a.menuOpen;e.setState({menuOpen:!e.state.menuOpen})}}];return s.a.createElement(le.a,{className:"menuContainer",iconOnly:!0,items:t,styles:this.props.styles,title:this.props.title})}}]),a}(s.a.Component),me=Object(v.a)()(ue),de=Object(E.b)((function(e){return{messagesList:e.messagesList}}),{selectMessage:ie,getMessagesList:ce,getDraftMessagesList:oe})(me),pe=(a(566),function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).localize=void 0,s.interval=void 0,s.isOpenTaskModuleAllowed=void 0,s.processLabels=function(){return[{key:"labels",content:n.createElement(S.a,{vAlign:"center",fill:!0,gap:"gap.small"},n.createElement(S.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},grow:1},n.createElement(w.a,{truncated:!0,weight:"bold",content:s.localize("TitleText")})),n.createElement(S.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"}},n.createElement(w.a,null)),n.createElement(S.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},shrink:!1},n.createElement(w.a,{truncated:!0,content:s.localize("Recipients"),weight:"bold"})),n.createElement(S.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"}},n.createElement(w.a,{truncated:!0,content:s.localize("Sent"),weight:"bold"})),n.createElement(S.a.Item,{shrink:0},n.createElement(de,{title:""}))),styles:{margin:"0.2rem 0.2rem 0 0"}}]},s.renderSendingText=function(e){var t="";switch(e.status){case"Queued":t=s.localize("Queued");break;case"SyncingRecipients":t=s.localize("SyncingRecipients");break;case"InstallingApp":t=s.localize("InstallingApp");break;case"Sending":var a=(e.succeeded?e.succeeded:0)+(e.failed?e.failed:0)+(e.unknown?e.unknown:0);t=s.localize("SendingMessages",{SentCount:R(a),TotalCount:R(e.totalMessageCount)});break;case"Sent":case"Failed":t=""}return n.createElement(w.a,{truncated:!0,content:t})},s.messageContent=function(e){return n.createElement(S.a,{className:"listContainer",vAlign:"center",fill:!0,gap:"gap.small"},n.createElement(S.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},grow:1},n.createElement(w.a,{truncated:!0,content:e.title})),n.createElement(S.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"}},s.renderSendingText(e)),n.createElement(S.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},shrink:!1},n.createElement("div",null,n.createElement(k.a,{content:s.props.t("TooltipSuccess"),calloutProps:{gapSpace:0}},n.createElement(y.a,{name:"stardust-checkmark",xSpacing:"after",className:"succeeded",outline:!0}),n.createElement("span",{className:"semiBold"},R(e.succeeded))),n.createElement(k.a,{content:s.props.t("TooltipFailure"),calloutProps:{gapSpace:0}},n.createElement(y.a,{name:"stardust-close",xSpacing:"both",className:"failed",outline:!0}),n.createElement("span",{className:"semiBold"},R(e.failed))),e.unknown&&n.createElement(k.a,{content:"Unknown",calloutProps:{gapSpace:0}},n.createElement(y.a,{name:"exclamation-circle",xSpacing:"both",className:"unknown",outline:!0}),n.createElement("span",{className:"semiBold"},R(e.unknown))))),n.createElement(S.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"}},n.createElement(w.a,{truncated:!0,className:"semiBold",content:e.sentDate})),n.createElement(S.a.Item,{shrink:0},n.createElement(de,{message:e,title:""})))},s.escFunction=function(e){27!==e.keyCode&&"Escape"!==e.key||p.tasks.submitTask()},s.onOpenTaskModule=function(e,t,a){if(s.isOpenTaskModuleAllowed){s.isOpenTaskModuleAllowed=!1;var n={url:t,title:a,height:530,width:1e3,fallbackUrl:t};p.tasks.startTask(n,(function(e,t){s.isOpenTaskModuleAllowed=!0}))}},Object(C.a)(),s.localize=s.props.t,s.isOpenTaskModuleAllowed=!0,s.state={message:s.props.messagesList,loader:!0},s.escFunction=s.escFunction.bind(Object(f.a)(s)),s}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;p.initialize(),this.props.getMessagesList(),document.addEventListener("keydown",this.escFunction,!1),this.interval=setInterval((function(){e.props.getMessagesList()}),6e4)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1),clearInterval(this.interval)}},{key:"componentWillReceiveProps",value:function(e){this.props!==e&&this.setState({message:e.messagesList,loader:!1})}},{key:"render",value:function(){var e=this,t=0,a=this.processLabels(),s=this.state.message.map((function(a){return{key:++t,content:e.messageContent(a),onClick:function(){var t=h()+"/viewstatus/"+a.id+"?locale={locale}";e.onOpenTaskModule(null,t,e.localize("ViewStatus"))},styles:{margin:"0.2rem 0.2rem 0 0"}}})),r=[].concat(Object(b.a)(a),Object(b.a)(s));return this.state.loader?n.createElement(x.a,null):0===this.state.message.length?n.createElement("div",{className:"results"},this.localize("EmptySentMessages")):n.createElement(O.a,{selectable:!0,items:r,className:"list"})}}]),a}(n.Component)),he=Object(v.a)()(pe),ge=Object(E.b)((function(e){return{messagesList:e.messagesList}}),{selectMessage:ie,getMessagesList:ce,getDraftMessagesList:oe})(he),fe=(a(567),function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).localize=void 0,n.onOpenTaskModule=function(e,t,a){var s={url:t,title:a,height:530,width:1e3,fallbackUrl:t};p.tasks.startTask(s,(function(e,t){n.props.getDraftMessagesList().then((function(){n.props.getMessagesList()}))}))},n.duplicateDraftMessage=function(){var e=Object(L.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Y(t);case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),n.deleteDraftMessage=function(){var e=Object(L.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,K(t);case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),n.localize=n.props.t,n.state={teamsChannelId:"",teamsTeamId:"",menuOpen:!1},n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;p.initialize(),p.getContext((function(t){e.setState({teamsTeamId:t.teamId,teamsChannelId:t.channelId})}))}},{key:"render",value:function(){var e=this,t=[{key:"more",icon:{name:"more",outline:!0},menuOpen:this.state.menuOpen,active:this.state.menuOpen,indicator:!1,menu:{items:[{key:"send",content:this.localize("Send"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1});var a=h()+"/sendconfirmation/"+e.props.message.id+"?locale={locale}";e.onOpenTaskModule(null,a,e.localize("SendConfirmation"))}},{key:"preview",content:this.localize("PreviewInThisChannel"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1});var a={draftNotificationId:e.props.message.id,teamsTeamId:e.state.teamsTeamId,teamsChannelId:e.state.teamsChannelId};se(a).then((function(e){return e.status})).catch((function(e){return e}))}},{key:"edit",content:this.localize("Edit"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1});var a=h()+"/newmessage/"+e.props.message.id+"?locale={locale}";e.onOpenTaskModule(null,a,e.localize("EditMessage"))}},{key:"duplicate",content:this.localize("Duplicate"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1}),e.duplicateDraftMessage(e.props.message.id).then((function(){e.props.getDraftMessagesList()}))}},{key:"delete",content:this.localize("Delete"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1}),e.deleteDraftMessage(e.props.message.id).then((function(){e.props.getDraftMessagesList()}))}}]},onMenuOpenChange:function(t,a){a.menuOpen;e.setState({menuOpen:!e.state.menuOpen})}}];return s.a.createElement(le.a,{className:"menuContainer",iconOnly:!0,items:t,styles:this.props.styles,title:this.props.title})}}]),a}(s.a.Component)),ve=Object(v.a)()(fe),be=Object(E.b)((function(e){return{messages:e.draftMessagesList,selectedMessage:e.selectedMessage}}),{selectMessage:ie,getDraftMessagesList:oe,getMessagesList:ce})(ve),Ee=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).localize=void 0,s.interval=void 0,s.isOpenTaskModuleAllowed=void 0,s.processLabels=function(){return[{key:"labels",content:n.createElement(S.a,{vAlign:"center",fill:!0,gap:"gap.small"},n.createElement(S.a.Item,null,n.createElement(w.a,{truncated:!0,weight:"bold",content:s.localize("TitleText")}))),styles:{margin:"0.2rem 0.2rem 0 0"}}]},s.onOpenTaskModule=function(e,t,a){if(s.isOpenTaskModuleAllowed){s.isOpenTaskModuleAllowed=!1;var n={url:t,title:a,height:530,width:1e3,fallbackUrl:t};p.tasks.startTask(n,(function(e,t){s.props.getDraftMessagesList().then((function(){s.props.getMessagesList(),s.isOpenTaskModuleAllowed=!0}))}))}},Object(C.a)(),s.localize=s.props.t,s.isOpenTaskModuleAllowed=!0,s.state={message:e.messages,itemsAccount:s.props.messages.length,loader:!0,teamsTeamId:"",teamsChannelId:""},s}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;p.initialize(),p.getContext((function(t){e.setState({teamsTeamId:t.teamId,teamsChannelId:t.channelId})})),this.props.getDraftMessagesList(),this.interval=setInterval((function(){e.props.getDraftMessagesList()}),6e4)}},{key:"componentWillReceiveProps",value:function(e){this.setState({message:e.messages,loader:!1})}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){var e=this,t=0,a=this.processLabels(),s=this.state.message.map((function(a){return{key:++t,content:n.createElement(S.a,{vAlign:"center",fill:!0,gap:"gap.small"},n.createElement(S.a.Item,{shrink:0,grow:1},n.createElement(w.a,null,a.title)),n.createElement(S.a.Item,{shrink:0,hAlign:"end",vAlign:"center"},n.createElement(be,{message:a,title:""}))),styles:{margin:"0.2rem 0.2rem 0 0"},onClick:function(){var t=h()+"/newmessage/"+a.id+"?locale={locale}";e.onOpenTaskModule(null,t,e.localize("EditMessage"))}}})),r=[].concat(Object(b.a)(a),Object(b.a)(s));return this.state.loader?n.createElement(x.a,null):0===this.state.message.length?n.createElement("div",{className:"results"},this.localize("EmptyDraftMessages")):n.createElement(O.a,{selectable:!0,items:r,className:"list"})}}]),a}(n.Component),ke=Object(v.a)()(Ee),Ce=Object(E.b)((function(e){return{messages:e.draftMessagesList,selectedMessage:e.selectedMessage}}),{selectMessage:ie,getDraftMessagesList:oe,getMessagesList:ce})(ke),Se=(a(568),a(58)),we=a(203),ye=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).localize=void 0,n.onNewMessage=function(){var e={url:n.state.url,title:n.localize("NewMessage"),height:530,width:1e3,fallbackUrl:n.state.url};p.tasks.startTask(e,(function(e,t){n.props.getDraftMessagesList()}))},n.localize=n.props.t,n.state={url:h()+"/newmessage?locale={locale}"},n.escFunction=n.escFunction.bind(Object(f.a)(n)),n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){p.initialize(),document.addEventListener("keydown",this.escFunction,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"escFunction",value:function(e){27!==e.keyCode&&"Escape"!==e.key||p.tasks.submitTask()}},{key:"render",value:function(){var e=[{title:this.localize("DraftMessagesSectionTitle"),content:{key:"sent",content:n.createElement("div",{className:"messages"},n.createElement(Ce,null))}},{title:this.localize("SentMessagesSectionTitle"),content:{key:"draft",content:n.createElement("div",{className:"messages"},n.createElement(ge,null))}}];return n.createElement("div",{className:"tabContainer"},n.createElement("div",{className:"newPostBtn"},n.createElement(Se.a,{content:this.localize("NewMessage"),onClick:this.onNewMessage,primary:!0})),n.createElement("div",{className:"messageContainer"},n.createElement(we.a,{defaultActiveIndex:[0,1],panels:e})))}}]),a}(n.Component),xe=Object(v.a)()(ye),Oe=Object(E.b)((function(e){return{messages:e.draftMessagesList}}),{getDraftMessagesList:oe})(xe),Te=a(44),Ne=a(129),Le=a(106),ze=(a(634),a(635),function(e){return{type:"AdaptiveCard",body:[{type:"TextBlock",weight:"Bolder",text:e("TitleText"),size:"ExtraLarge",wrap:!0},{type:"Image",spacing:"Default",url:"",size:"Stretch",width:"400px",altText:""},{type:"TextBlock",text:"",wrap:!0},{type:"TextBlock",wrap:!0,size:"Small",weight:"Lighter",text:""}],$schema:"https://adaptivecards.io/schemas/adaptive-card.json",version:"1.0"}}),Me=function(e,t){e.body[0].text=t},je=function(e,t){e.body[1].url=t},Ie=function(e,t){e.body[2].text=t},Ae=function(e,t){e.body[3].text=t},De=function(e,t,a){t&&a?e.actions=[{type:"Action.OpenUrl",title:t,url:a}]:delete e.actions},Ue=a(405),Re=a.n(Ue),Be=function e(){Object(c.a)(this,e)};Be.makeInitialImage=function(e){var t=document.createElement("canvas");t.style.display="none",t.width=32,t.height=32,document.body.appendChild(t);var a=t.getContext("2d");if(a){var n=(new Re.a).hex(e);a.fillStyle=n,a.fillRect(0,0,t.width,t.height),a.font="16px Arial",a.fillStyle="#fff";var s=e.split(" "),r=s.length,i=s[0][0];if(r>1){var c=i+s[r-1][0];a.fillText(c.toUpperCase(),3,23)}else a.fillText(i.toUpperCase(),10,23);var o=t.toDataURL();return document.body.removeChild(t),o}return""};var Fe=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).localize=void 0,n.card=void 0,n.csvfilename=void 0,n.makeDropdownItems=function(e){var t=[];return e&&e.forEach((function(e){t.push({key:e.id,header:e.name,content:e.mail,image:Be.makeInitialImage(e.name),team:{id:e.id}})})),t},n.makeDropdownItemList=function(e,t){var a=[];return e.forEach((function(e){return a.push("string"!==typeof e?e:{key:t.find((function(t){return t.id===e})).id,header:t.find((function(t){return t.id===e})).name,image:Be.makeInitialImage(t.find((function(t){return t.id===e})).name),team:{id:e}})})),a},n.setDefaultCard=function(e){var t=n.localize("TitleText"),a=n.localize("Summary"),s=n.localize("Author1"),r=n.localize("ButtonTitle");Me(e,t);var i=h()+"/image/imagePlaceholder.png";je(e,i),Ie(e,a),Ae(e,s),De(e,r,"https://adaptivecards.io")},n.getTeamList=Object(L.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae();case 3:t=e.sent,n.setState({teams:t.data}),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),n.setGroupAccess=Object(L.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W().then((function(){n.setState({groupAccess:!0})})).catch((function(e){if(403!==e.response.status)throw e;n.setState({groupAccess:!1})}));case 2:case"end":return e.stop()}}),e)}))),n.getGroupData=function(){var e=Object(L.a)(N.a.mark((function e(t){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Q(t);case 3:a=e.sent,n.setState({groups:a.data}),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),n.getItem=function(){var e=Object(L.a)(N.a.mark((function e(t){var a,s,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$(t);case 3:a=e.sent,s=a.data,r="teams",s.rosters.length>0?r="rosters":s.groups.length>0?r="groups":s.allUsers?r="allUsers":s.csvlist&&(r="csvlist"),n.setState({teamsOptionSelected:s.teams.length>0,selectedTeamsNum:s.teams.length,rostersOptionSelected:s.rosters.length>0,selectedRostersNum:s.rosters.length,groupsOptionSelected:s.groups.length>0,selectedGroupsNum:s.groups.length,selectedRadioBtn:r,selectedTeams:s.teams,selectedRosters:s.rosters,selectedGroups:s.groups}),Me(n.card,s.title),je(n.card,s.imageLink),Ie(n.card,s.summary),Ae(n.card,s.author),De(n.card,s.buttonTitle,s.buttonLink),n.setState({title:s.title,summary:s.summary,btnLink:s.buttonLink,imageLink:s.imageLink,btnTitle:s.buttonTitle,author:s.author,allUsersOptionSelected:s.allUsers,loader:!1},(function(){n.updateCard()})),e.next=19;break;case 16:return e.prev=16,e.t0=e.catch(0),e.abrupt("return",e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t){return e.apply(this,arguments)}}(),n.onGroupSelected=function(e){n.setState({selectedRadioBtn:e,teamsOptionSelected:"teams"===e,rostersOptionSelected:"rosters"===e,groupsOptionSelected:"groups"===e,allUsersOptionSelected:"allUsers"===e,selectedTeams:"teams"===e?n.state.selectedTeams:[],selectedTeamsNum:"teams"===e?n.state.selectedTeamsNum:0,selectedRosters:"rosters"===e?n.state.selectedRosters:[],selectedRostersNum:"rosters"===e?n.state.selectedRostersNum:0,selectedGroups:"groups"===e?n.state.selectedGroups:[],selectedGroupsNum:"groups"===e?n.state.selectedGroupsNum:0})},n.isSaveBtnDisabled=function(){var e=n.state.teamsOptionSelected&&0!==n.state.selectedTeamsNum||!n.state.teamsOptionSelected,t=n.state.rostersOptionSelected&&0!==n.state.selectedRostersNum||!n.state.rostersOptionSelected,a=n.state.groupsOptionSelected&&0!==n.state.selectedGroupsNum||!n.state.groupsOptionSelected,s=!n.state.teamsOptionSelected&&!n.state.rostersOptionSelected&&!n.state.groupsOptionSelected&&!n.state.allUsersOptionSelected;return!e||!t||!a||s},n.isNextBtnDisabled=function(){var e=n.state.title,t=n.state.btnTitle,a=n.state.btnLink;return!(e&&(t&&a||!t&&!a)&&""===n.state.errorImageUrlMessage&&""===n.state.errorButtonUrlMessage)},n.getItems=function(){var e=[];if(n.state.teams){var t=n.state.teams;"allUsers"!==n.state.selectedRadioBtn&&("teams"===n.state.selectedRadioBtn?n.state.teams.filter((function(e){return n.state.selectedTeams.findIndex((function(t){return t.team.id===e.id}))<0})):"rosters"===n.state.selectedRadioBtn&&n.state.teams.filter((function(e){return n.state.selectedRosters.findIndex((function(t){return t.team.id===e.id}))<0}))),t.forEach((function(t){e.push({key:t.id,header:t.name,content:t.mail,image:Be.makeInitialImage(t.name),team:{id:t.id}})}))}return e},n.onTeamsChange=function(e,t){t.value.length>a.MAX_SELECTED_TEAMS_NUM||n.setState({selectedTeams:t.value,selectedTeamsNum:t.value.length,selectedRosters:[],selectedRostersNum:0,selectedGroups:[],selectedGroupsNum:0})},n.onRostersChange=function(e,t){t.value.length>a.MAX_SELECTED_TEAMS_NUM||n.setState({selectedRosters:t.value,selectedRostersNum:t.value.length,selectedTeams:[],selectedTeamsNum:0,selectedGroups:[],selectedGroupsNum:0})},n.onGroupsChange=function(e,t){n.setState({selectedGroups:t.value,selectedGroupsNum:t.value.length,groups:[],selectedTeams:[],selectedTeamsNum:0,selectedRosters:[],selectedRostersNum:0})},n.onGroupSearch=function(e,t){return e.filter((function(e){return e.header&&-1!==e.header.toLowerCase().indexOf(t.toLowerCase())||e.content&&-1!==e.content.toLowerCase().indexOf(t.toLowerCase())}))},n.onGroupSearchQueryChange=function(){var e=Object(L.a)(N.a.mark((function e(t,a){var s,r;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.searchQuery){e.next=4;break}n.setState({groups:[],noResultMessage:""}),e.next=24;break;case 4:if(!(a.searchQuery&&a.searchQuery.length<=2)){e.next=8;break}n.setState({loading:!1,noResultMessage:"No matches found."}),e.next=24;break;case 8:if(!(a.searchQuery&&a.searchQuery.length>2)){e.next=24;break}if(!(a.items&&a.items.find((function(e){return e.header.toLowerCase()===a.searchQuery.toLowerCase()})))){e.next=12;break}return e.abrupt("return");case 12:return n.setState({loading:!0,noResultMessage:""}),e.prev=13,s=encodeURIComponent(a.searchQuery),e.next=17,V(s);case 17:r=e.sent,n.setState({groups:r.data,loading:!1,noResultMessage:"No matches found."}),e.next=24;break;case 21:return e.prev=21,e.t0=e.catch(13),e.abrupt("return",e.t0);case 24:case"end":return e.stop()}}),e,null,[[13,21]])})));return function(t,a){return e.apply(this,arguments)}}(),n.onSave=function(){var e=[],t=[],a=[];n.state.selectedTeams.forEach((function(t){return e.push(t.team.id)})),n.state.selectedRosters.forEach((function(e){return t.push(e.team.id)})),n.state.selectedGroups.forEach((function(e){return a.push(e.team.id)}));var s={id:n.state.messageId,title:n.state.title,imageLink:n.state.imageLink,summary:n.state.summary,author:n.state.author,buttonTitle:n.state.btnTitle,buttonLink:n.state.btnLink,teams:e,rosters:t,groups:a,allUsers:n.state.allUsersOptionSelected,csvlist:n.state.csvlistOptionSelected};n.state.exists?n.editDraftMessage(s).then((function(){p.tasks.submitTask()})):n.postDraftMessage(s).then((function(){p.tasks.submitTask()}))},n.editDraftMessage=function(){var e=Object(L.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ee(t);case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),n.postDraftMessage=function(){var e=Object(L.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,te(t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),n.onNext=function(e){n.setState({page:"AudienceSelection"},(function(){n.updateCard()}))},n.onBack=function(e){n.setState({page:"CardCreation"},(function(){n.updateCard()}))},n.onTitleChanged=function(e){var t=!e.target.value&&!n.state.imageLink&&!n.state.summary&&!n.state.author&&!n.state.btnTitle&&!n.state.btnLink;Me(n.card,e.target.value),je(n.card,n.state.imageLink),Ie(n.card,n.state.summary),Ae(n.card,n.state.author),De(n.card,n.state.btnTitle,n.state.btnLink),n.setState({title:e.target.value,card:n.card},(function(){t&&n.setDefaultCard(n.card),n.updateCard()}))},n.onImageLinkChanged=function(e){var t=e.target.value.toLowerCase();""===t||t.startsWith("https://")||t.startsWith("data:image/png;base64,")||t.startsWith("data:image/jpeg;base64,")||t.startsWith("data:image/gif;base64,")?n.setState({errorImageUrlMessage:""}):n.setState({errorImageUrlMessage:"URL must start with https://"});var a=!n.state.title&&!e.target.value&&!n.state.summary&&!n.state.author&&!n.state.btnTitle&&!n.state.btnLink;Me(n.card,n.state.title),je(n.card,e.target.value),Ie(n.card,n.state.summary),Ae(n.card,n.state.author),De(n.card,n.state.btnTitle,n.state.btnLink),n.setState({imageLink:e.target.value,card:n.card},(function(){a&&n.setDefaultCard(n.card),n.updateCard()}))},n.onSummaryChanged=function(e){var t=!n.state.title&&!n.state.imageLink&&!e.target.value&&!n.state.author&&!n.state.btnTitle&&!n.state.btnLink;Me(n.card,n.state.title),je(n.card,n.state.imageLink),Ie(n.card,e.target.value),Ae(n.card,n.state.author),De(n.card,n.state.btnTitle,n.state.btnLink),n.setState({summary:e.target.value,card:n.card},(function(){t&&n.setDefaultCard(n.card),n.updateCard()}))},n.onAuthorChanged=function(e){var t=!n.state.title&&!n.state.imageLink&&!n.state.summary&&!e.target.value&&!n.state.btnTitle&&!n.state.btnLink;Me(n.card,n.state.title),je(n.card,n.state.imageLink),Ie(n.card,n.state.summary),Ae(n.card,e.target.value),De(n.card,n.state.btnTitle,n.state.btnLink),n.setState({author:e.target.value,card:n.card},(function(){t&&n.setDefaultCard(n.card),n.updateCard()}))},n.onBtnTitleChanged=function(e){var t=!n.state.title&&!n.state.imageLink&&!n.state.summary&&!n.state.author&&!e.target.value&&!n.state.btnLink;Me(n.card,n.state.title),je(n.card,n.state.imageLink),Ie(n.card,n.state.summary),Ae(n.card,n.state.author),e.target.value&&n.state.btnLink?(De(n.card,e.target.value,n.state.btnLink),n.setState({btnTitle:e.target.value,card:n.card},(function(){t&&n.setDefaultCard(n.card),n.updateCard()}))):(delete n.card.actions,n.setState({btnTitle:e.target.value},(function(){t&&n.setDefaultCard(n.card),n.updateCard()})))},n.onBtnLinkChanged=function(e){""===e.target.value||e.target.value.toLowerCase().startsWith("https://")?n.setState({errorButtonUrlMessage:""}):n.setState({errorButtonUrlMessage:"URL must start with https://"});var t=!n.state.title&&!n.state.imageLink&&!n.state.summary&&!n.state.author&&!n.state.btnTitle&&!e.target.value;Me(n.card,n.state.title),Ie(n.card,n.state.summary),Ae(n.card,n.state.author),je(n.card,n.state.imageLink),n.state.btnTitle&&e.target.value?(De(n.card,n.state.btnTitle,e.target.value),n.setState({btnLink:e.target.value,card:n.card},(function(){t&&n.setDefaultCard(n.card),n.updateCard()}))):(delete n.card.actions,n.setState({btnLink:e.target.value},(function(){t&&n.setDefaultCard(n.card),n.updateCard()})))},n.updateCard=function(){var e=new Ne.AdaptiveCard;e.parse(n.state.card);var t=e.render(),a=document.getElementsByClassName("adaptiveCardContainer")[0].firstChild;null!=a?a.replaceWith(t):document.getElementsByClassName("adaptiveCardContainer")[0].appendChild(t);var s=n.state.btnLink;e.onExecuteAction=function(e){window.open(s,"_blank")}},Object(C.a)(),n.localize=n.props.t,n.card=ze(n.localize),n.setDefaultCard(n.card),n.csvfilename="AAAAAAAAAAAAAAAAA",n.state={title:"",summary:"",author:"",btnLink:"",imageLink:"",btnTitle:"",card:n.card,page:"CardCreation",teamsOptionSelected:!0,rostersOptionSelected:!1,allUsersOptionSelected:!1,groupsOptionSelected:!1,csvlistOptionSelected:!1,messageId:"",loader:!0,groupAccess:!1,loading:!1,noResultMessage:"",unstablePinned:!0,selectedTeamsNum:0,selectedRostersNum:0,selectedGroupsNum:0,selectedRadioBtn:"teams",selectedTeams:[],selectedRosters:[],selectedGroups:[],errorImageUrlMessage:"",errorButtonUrlMessage:""},n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=Object(L.a)(N.a.mark((function e(){var t,a=this;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p.initialize(),document.addEventListener("keydown",this.escFunction,!1),t=this.props.match.params,this.setGroupAccess(),this.getTeamList().then((function(){if("id"in t){var e=t.id;a.getItem(e).then((function(){var t=a.makeDropdownItemList(a.state.selectedTeams,a.state.teams),n=a.makeDropdownItemList(a.state.selectedRosters,a.state.teams);a.setState({exists:!0,messageId:e,selectedTeams:t,selectedRosters:n})})),a.getGroupData(e).then((function(){var e=a.makeDropdownItems(a.state.groups);a.setState({selectedGroups:e})}))}else a.setState({exists:!1,loader:!1},(function(){var e=new Ne.AdaptiveCard;e.parse(a.state.card);var t=e.render();if(document.getElementsByClassName("adaptiveCardContainer")[0].appendChild(t),a.state.btnLink){var n=a.state.btnLink;e.onExecuteAction=function(e){window.open(n,"_blank")}}}))}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getGroupItems",value:function(){if(this.state.groups)return this.makeDropdownItems(this.state.groups);return[]}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"render",value:function(){return this.state.loader?n.createElement("div",{className:"Loader"},n.createElement(x.a,null)):"CardCreation"===this.state.page?n.createElement("div",{className:"taskModule"},n.createElement("div",{className:"formContainer"},n.createElement("div",{className:"formContentContainer"},n.createElement(Te.Input,{className:"inputField",value:this.state.title,label:this.localize("TitleText"),placeholder:this.localize("PlaceHolderTitle"),onChange:this.onTitleChanged,autoComplete:"off",required:!0}),n.createElement(Te.Input,{className:"inputField",value:this.state.imageLink,label:this.localize("ImageURL"),placeholder:this.localize("ImageURL"),onChange:this.onImageLinkChanged,errorLabel:this.state.errorImageUrlMessage,autoComplete:"off"}),n.createElement(Te.TextArea,{className:"inputField textArea",autoFocus:!0,placeholder:this.localize("Summary"),label:this.localize("Summary"),value:this.state.summary,onChange:this.onSummaryChanged}),n.createElement(Te.Input,{className:"inputField",value:this.state.author,label:this.localize("Author"),placeholder:this.localize("Author"),onChange:this.onAuthorChanged,autoComplete:"off"}),n.createElement(Te.Input,{className:"inputField",value:this.state.btnTitle,label:this.localize("ButtonTitle"),placeholder:this.localize("ButtonTitle"),onChange:this.onBtnTitleChanged,autoComplete:"off"}),n.createElement(Te.Input,{className:"inputField",value:this.state.btnLink,label:this.localize("ButtonURL"),placeholder:this.localize("ButtonURL"),onChange:this.onBtnLinkChanged,errorLabel:this.state.errorButtonUrlMessage,autoComplete:"off"})),n.createElement("div",{className:"adaptiveCardContainer"})),n.createElement("div",{className:"footerContainer"},n.createElement("div",{className:"buttonContainer"},n.createElement(Se.a,{content:this.localize("Next"),disabled:this.isNextBtnDisabled(),id:"saveBtn",onClick:this.onNext,primary:!0})))):"AudienceSelection"===this.state.page?n.createElement("div",{className:"taskModule"},n.createElement("div",{className:"formContainer"},n.createElement("div",{className:"formContentContainer"},n.createElement("h3",null,this.localize("SendHeadingText")),n.createElement(Te.RadiobuttonGroup,{className:"radioBtns",value:this.state.selectedRadioBtn,onSelected:this.onGroupSelected},n.createElement(Te.Radiobutton,{name:"grouped",value:"teams",label:this.localize("SendToGeneralChannel")}),n.createElement(Le.a,{hidden:!this.state.teamsOptionSelected,placeholder:this.localize("SendToGeneralChannelPlaceHolder"),search:!0,multiple:!0,items:this.getItems(),value:this.state.selectedTeams,onSelectedChange:this.onTeamsChange,noResultsMessage:this.localize("NoMatchMessage")}),n.createElement(Te.Radiobutton,{name:"grouped",value:"rosters",label:this.localize("SendToRosters")}),n.createElement(Le.a,{hidden:!this.state.rostersOptionSelected,placeholder:this.localize("SendToRostersPlaceHolder"),search:!0,multiple:!0,items:this.getItems(),value:this.state.selectedRosters,onSelectedChange:this.onRostersChange,unstable_pinned:this.state.unstablePinned,noResultsMessage:this.localize("NoMatchMessage")}),n.createElement(Te.Radiobutton,{name:"grouped",value:"allUsers",label:this.localize("SendToAllUsers")}),n.createElement("div",{className:"allUsers"===this.state.selectedRadioBtn?"":"hide"},n.createElement("div",{className:"noteText"},n.createElement(w.a,{error:!0,content:this.localize("SendToAllUsersNote")}))),n.createElement(Te.Radiobutton,{name:"grouped",value:"groups",label:this.localize("SendToGroups")}),n.createElement("div",{className:this.state.groupsOptionSelected&&!this.state.groupAccess?"":"hide"},n.createElement("div",{className:"noteText"},n.createElement(w.a,{error:!0,content:this.localize("SendToGroupsPermissionNote")}))),n.createElement(Le.a,{className:"hideToggle",hidden:!this.state.groupsOptionSelected||!this.state.groupAccess,placeholder:this.localize("SendToGroupsPlaceHolder"),search:this.onGroupSearch,multiple:!0,loading:this.state.loading,loadingMessage:this.localize("LoadingText"),items:this.getGroupItems(),value:this.state.selectedGroups,onSearchQueryChange:this.onGroupSearchQueryChange,onSelectedChange:this.onGroupsChange,noResultsMessage:this.state.noResultMessage,unstable_pinned:this.state.unstablePinned}),n.createElement("div",{className:this.state.groupsOptionSelected&&this.state.groupAccess?"":"hide"},n.createElement("div",{className:"noteText"},n.createElement(w.a,{error:!0,content:this.localize("SendToGroupsNote")}))),n.createElement(Te.Radiobutton,{name:"grouped",value:"csvlist",label:this.csvfilename}),n.createElement("input",{type:"file",multiple:!1,id:"csv",name:"csv",accept:"file/csv",onChange:this.handleFileChange}),n.createElement("div",{className:"noteText"},n.createElement(w.a,{error:!0,content:this.csvfilename})))),n.createElement("div",{className:"adaptiveCardContainer"})),n.createElement("div",{className:"footerContainer"},n.createElement("div",{className:"buttonContainer"},n.createElement(Se.a,{content:this.localize("Back"),onClick:this.onBack,secondary:!0}),n.createElement(Se.a,{content:this.localize("SaveAsDraft"),disabled:this.isSaveBtnDisabled(),id:"saveBtn",onClick:this.onSave,primary:!0})))):n.createElement("div",null,"Error")}},{key:"escFunction",value:function(e){27!==e.keyCode&&"Escape"!==e.key||p.tasks.submitTask()}},{key:"handleFileChange",value:function(e){null!=e.currentTarget.files&&null!=e.currentTarget.files[0]&&(this.csvfilename="Filename = "+e.currentTarget.files[0].name),console.log("handleFileChange triggered"),e.persist(),null!=e.currentTarget.files&&console.log(e.currentTarget.files[0].name)}}]),a}(n.Component);Fe.MAX_SELECTED_TEAMS_NUM=20;var Ge=Object(v.a)()(Fe),Pe=(a(639),a(66)),_e=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).localize=void 0,s.initMessage={id:"",title:""},s.card=void 0,s.getItem=function(){var e=Object(L.a)(N.a.mark((function e(t){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,J(t);case 3:(a=e.sent).data.sendingDuration=U(a.data.sendingStartedDate,a.data.sentDate),a.data.sendingStartedDate=D(a.data.sendingStartedDate),a.data.sentDate=D(a.data.sentDate),a.data.succeeded=R(a.data.succeeded),a.data.failed=R(a.data.failed),a.data.unknown=a.data.unknown&&R(a.data.unknown),s.setState({message:a.data}),e.next=16;break;case 13:return e.prev=13,e.t0=e.catch(0),e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),s.onClose=function(){p.tasks.submitTask()},s.onExport=Object(L.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.getElementsByClassName("sendingLoader")[0].classList.remove("hiddenLoader"),t={id:s.state.message.id,teamId:s.state.teamId},e.next=5,X(t).then((function(){s.setState({page:"SuccessPage"})})).catch((function(){s.setState({page:"ErrorPage"})}));case 5:case"end":return e.stop()}}),e)}))),s.getItemList=function(e){var t=[];return e&&(t=e.map((function(e){return{header:e,media:n.createElement(Pe.a,{src:Be.makeInitialImage(e),avatar:!0})}}))),t},s.renderAudienceSelection=function(){return s.state.message.teamNames&&s.state.message.teamNames.length>0?n.createElement("div",null,n.createElement("h3",null,s.localize("SentToGeneralChannel")),n.createElement(O.a,{items:s.getItemList(s.state.message.teamNames)})):s.state.message.rosterNames&&s.state.message.rosterNames.length>0?n.createElement("div",null,n.createElement("h3",null,s.localize("SentToRosters")),n.createElement(O.a,{items:s.getItemList(s.state.message.rosterNames)})):s.state.message.groupNames&&s.state.message.groupNames.length>0?n.createElement("div",null,n.createElement("h3",null,s.localize("SentToGroups1")),n.createElement("span",null,s.localize("SentToGroups2")),n.createElement(O.a,{items:s.getItemList(s.state.message.groupNames)})):s.state.message.allUsers?n.createElement("div",null,n.createElement("h3",null,s.localize("SendToAllUsers"))):n.createElement("div",null)},s.renderErrorMessage=function(){return s.state.message.errorMessage?n.createElement("div",null,n.createElement("h3",null,s.localize("Errors")),n.createElement("span",null,s.state.message.errorMessage)):n.createElement("div",null)},s.renderWarningMessage=function(){return s.state.message.warningMessage?n.createElement("div",null,n.createElement("h3",null,s.localize("Warnings")),n.createElement("span",null,s.state.message.warningMessage)):n.createElement("div",null)},Object(C.a)(),s.localize=s.props.t,s.card=ze(s.props.t),s.state={message:s.initMessage,loader:!0,page:"ViewStatus",teamId:""},s}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params;if(p.initialize(),p.getContext((function(t){e.setState({teamId:t.teamId})})),"id"in t){var a=t.id;this.getItem(a).then((function(){e.setState({loader:!1},(function(){Me(e.card,e.state.message.title),je(e.card,e.state.message.imageLink),Ie(e.card,e.state.message.summary),Ae(e.card,e.state.message.author),""!==e.state.message.buttonTitle&&""!==e.state.message.buttonLink&&De(e.card,e.state.message.buttonTitle,e.state.message.buttonLink);var t=new Ne.AdaptiveCard;t.parse(e.card);var a=t.render();document.getElementsByClassName("adaptiveCardContainer")[0].appendChild(a);var n=e.state.message.buttonLink;t.onExecuteAction=function(e){window.open(n,"_blank")}}))}))}}},{key:"render",value:function(){if(this.state.loader)return n.createElement("div",{className:"Loader"},n.createElement(x.a,null));return"ViewStatus"===this.state.page?n.createElement("div",{className:"taskModule"},n.createElement("div",{className:"formContainer"},n.createElement("div",{className:"formContentContainer"},n.createElement("div",{className:"contentField"},n.createElement("h3",null,this.localize("TitleText")),n.createElement("span",null,this.state.message.title)),n.createElement("div",{className:"contentField"},n.createElement("h3",null,this.localize("SendingStarted")),n.createElement("span",null,this.state.message.sendingStartedDate)),n.createElement("div",{className:"contentField"},n.createElement("h3",null,this.localize("Completed")),n.createElement("span",null,this.state.message.sentDate)),n.createElement("div",{className:"contentField"},n.createElement("h3",null,this.localize("Duration")),n.createElement("span",null,this.state.message.sendingDuration)),n.createElement("div",{className:"contentField"},n.createElement("h3",null,this.localize("Results")),n.createElement("label",null,this.localize("Success",{SuccessCount:this.state.message.succeeded})),n.createElement("br",null),n.createElement("label",null,this.localize("Failure",{FailureCount:this.state.message.failed})),n.createElement("br",null),this.state.message.unknown&&n.createElement(n.Fragment,null,n.createElement("label",null,this.localize("Unknown",{UnknownCount:this.state.message.unknown})))),n.createElement("div",{className:"contentField"},this.renderAudienceSelection()),n.createElement("div",{className:"contentField"},this.renderErrorMessage()),n.createElement("div",{className:"contentField"},this.renderWarningMessage())),n.createElement("div",{className:"adaptiveCardContainer"})),n.createElement("div",{className:"footerContainer"},n.createElement("div",{className:this.state.message.canDownload?"":"disabled"},n.createElement("div",{className:"buttonContainer"},n.createElement(x.a,{id:"sendingLoader",className:"hiddenLoader sendingLoader",size:"smallest",label:this.localize("ExportLabel"),labelPosition:"end"}),n.createElement(k.a,{content:this.state.message.sendingCompleted?this.state.message.canDownload?"":this.localize("ExportButtonProgressText"):"",calloutProps:{gapSpace:0}},n.createElement(Se.a,{icon:{name:"download",size:"medium"},disabled:!this.state.message.canDownload||!this.state.message.sendingCompleted,content:this.localize("ExportButtonText"),id:"exportBtn",onClick:this.onExport,primary:!0})))))):"SuccessPage"===this.state.page?n.createElement("div",{className:"taskModule"},n.createElement("div",{className:"formContainer"},n.createElement("div",{className:"displayMessageField"},n.createElement("br",null),n.createElement("br",null),n.createElement("div",null,n.createElement("span",null,n.createElement(y.a,{className:"iconStyle",name:"stardust-checkmark",xSpacing:"before",size:"largest",outline:!0})),n.createElement("h1",null,this.localize("ExportQueueTitle"))),n.createElement("span",null,this.localize("ExportQueueSuccessMessage1")),n.createElement("br",null),n.createElement("br",null),n.createElement("span",null,this.localize("ExportQueueSuccessMessage2")),n.createElement("br",null),n.createElement("span",null,this.localize("ExportQueueSuccessMessage3")))),n.createElement("div",{className:"footerContainer"},n.createElement("div",{className:"buttonContainer"},n.createElement(Se.a,{content:this.localize("CloseText"),id:"closeBtn",onClick:this.onClose,primary:!0})))):n.createElement("div",{className:"taskModule"},n.createElement("div",{className:"formContainer"},n.createElement("div",{className:"displayMessageField"},n.createElement("br",null),n.createElement("br",null),n.createElement("div",null,n.createElement("span",null,n.createElement(y.a,{className:"iconStyle",name:"stardust-close",xSpacing:"before",size:"largest",outline:!0})),n.createElement("h1",{className:"light"},this.localize("ExportErrorTitle"))),n.createElement("span",null,this.localize("ExportErrorMessage")))),n.createElement("div",{className:"footerContainer"},n.createElement("div",{className:"buttonContainer"},n.createElement(Se.a,{content:this.localize("CloseText"),id:"closeBtn",onClick:this.onClose,primary:!0}))))}}]),a}(n.Component),He=Object(v.a)()(_e),qe=(a(640),a(202)),We=a(57),Qe=(a(641),function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).localize=void 0,s.initMessage={id:"",title:""},s.card=void 0,s.getItem=function(){var e=Object(L.a)(N.a.mark((function e(t){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$(t);case 3:a=e.sent,s.setState({message:a.data}),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),s.onSendMessage=function(){document.getElementsByClassName("sendingLoader")[0].classList.remove("hiddenLoader"),Z(s.state.message).then((function(){p.tasks.submitTask()}))},s.getItemList=function(e){var t=[];return e&&(t=e.map((function(e){return{header:e,media:n.createElement(Pe.a,{src:Be.makeInitialImage(e),avatar:!0})}}))),t},s.renderAudienceSelection=function(){return s.state.teamNames&&s.state.teamNames.length>0?n.createElement("div",{key:"teamNames"}," ",n.createElement("span",{className:"label"},s.localize("TeamsLabel")),n.createElement(O.a,{items:s.getItemList(s.state.teamNames)})):s.state.rosterNames&&s.state.rosterNames.length>0?n.createElement("div",{key:"rosterNames"}," ",n.createElement("span",{className:"label"},s.localize("TeamsMembersLabel")),n.createElement(O.a,{items:s.getItemList(s.state.rosterNames)})):s.state.groupNames&&s.state.groupNames.length>0?n.createElement("div",{key:"groupNames"}," ",n.createElement("span",{className:"label"},s.localize("GroupsMembersLabel")),n.createElement(O.a,{items:s.getItemList(s.state.groupNames)})):s.state.allUsers?n.createElement("div",{key:"allUsers"},n.createElement("span",{className:"label"},s.localize("AllUsersLabel")),n.createElement("div",{className:"noteText"},n.createElement(w.a,{error:!0,content:s.localize("SendToAllUsersNote")}))):n.createElement("div",null)},s.localize=s.props.t,s.card=ze(s.localize),s.state={message:s.initMessage,loader:!0,teamNames:[],rosterNames:[],groupNames:[],allUsers:!1,messageId:0},s}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;p.initialize();var t=this.props.match.params;if("id"in t){var a=t.id;this.getItem(a).then((function(){ne(a).then((function(t){e.setState({teamNames:t.data.teamNames.sort(),rosterNames:t.data.rosterNames.sort(),groupNames:t.data.groupNames.sort(),allUsers:t.data.allUsers,messageId:a},(function(){e.setState({loader:!1},(function(){Me(e.card,e.state.message.title),je(e.card,e.state.message.imageLink),Ie(e.card,e.state.message.summary),Ae(e.card,e.state.message.author),e.state.message.buttonTitle&&e.state.message.buttonLink&&De(e.card,e.state.message.buttonTitle,e.state.message.buttonLink);var t=new Ne.AdaptiveCard;t.parse(e.card);var a=t.render();if(document.getElementsByClassName("adaptiveCardContainer")[0].appendChild(a),e.state.message.buttonLink){var n=e.state.message.buttonLink;t.onExecuteAction=function(e){window.open(n,"_blank")}}}))}))}))}))}}},{key:"render",value:function(){return this.state.loader?n.createElement("div",{className:"Loader"},n.createElement(x.a,null)):n.createElement("div",{className:"taskModule"},n.createElement("div",{className:"formContainer"},n.createElement("div",{className:"formContentContainer"},n.createElement("div",{className:"contentField"},n.createElement("h3",null,this.localize("ConfirmToSend")),n.createElement("span",null,this.localize("SendToRecipientsLabel"))),n.createElement("div",{className:"results"},this.renderAudienceSelection())),n.createElement("div",{className:"adaptiveCardContainer"})),n.createElement("div",{className:"footerContainer"},n.createElement("div",{className:"buttonContainer"},n.createElement(x.a,{id:"sendingLoader",className:"hiddenLoader sendingLoader",size:"smallest",label:this.localize("PreparingMessageLabel"),labelPosition:"end"}),n.createElement(Se.a,{content:this.localize("Send"),id:"sendBtn",onClick:this.onSendMessage,primary:!0}))))}}]),a}(n.Component)),Ve=Object(v.a)()(Qe),Xe=a(397),Je=(a(642),function(e){var t=Object(Xe.a)().t;return s.a.createElement(w.a,{content:function(){var a=e.match.params;if("id"in a){var n=a.id;if("401"===n)return t("UnauthorizedErrorMessage");if("403"===n)return t("ForbiddenErrorMessage")}return t("GeneralErrorMessage")}(),className:"error-message",error:!0,size:"medium"})}),$e=(a(643),function(e){var t=Object(Xe.a)().t,a=t("SignInPromptMessage");return s.a.createElement("div",{className:"sign-in-content-container"},s.a.createElement(w.a,{content:a,size:"medium"}),s.a.createElement("div",{className:"space"}),s.a.createElement(Se.a,{content:t("SignIn"),primary:!0,className:"sign-in-button",onClick:function(){p.authentication.authenticate({url:window.location.origin+"/signin-simple-start",successCallback:function(){console.log("Login succeeded!"),window.location.href="/messages"},failureCallback:function(e){console.log("Login failed: "+e),window.location.href="/errorpage?locale=".concat(B.language)}})}}))}),Ke=function(){return Object(n.useEffect)((function(){p.initialize(),p.getContext((function(e){var t=window.location.origin.replace("https://",""),a=e.upn?e.upn:"";re(t,a).then((function(e){window.location.assign(e.data)}))}))})),s.a.createElement(s.a.Fragment,null)},Ye=function(){return Object(n.useEffect)((function(){p.initialize();var e=function(){var e={};return window.location.hash.substr(1).split("&").forEach((function(t){var a=t.split("="),n=a[0],s=a[1]&&decodeURIComponent(a[1]);e[n]=s})),e}();e.error?p.authentication.notifyFailure(e.error):e.id_token?p.authentication.notifySuccess():p.authentication.notifyFailure("UnexpectedFailure")})),s.a.createElement(s.a.Fragment,null)},Ze=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e)).setThemeComponent=function(){return"dark"===r.state.theme?s.a.createElement(qe.a,{theme:We.themes.teamsDark},s.a.createElement("div",{className:"darkContainer"},r.getAppDom())):"contrast"===r.state.theme?s.a.createElement(qe.a,{theme:We.themes.teamsHighContrast},s.a.createElement("div",{className:"highContrastContainer"},r.getAppDom())):s.a.createElement(qe.a,{theme:We.themes.teams},s.a.createElement("div",{className:"defaultContainer"},r.getAppDom()))},r.updateTheme=function(e){"dark"===e?r.setState({themeStyle:Te.ThemeStyle.Dark}):"contrast"===e?r.setState({themeStyle:Te.ThemeStyle.HighContrast}):r.setState({themeStyle:Te.ThemeStyle.Light})},r.getAppDom=function(){var e=Object(Te.getContext)({baseFontSize:10,style:r.state.themeStyle});return s.a.createElement(Te.TeamsThemeContext.Provider,{value:e},s.a.createElement(n.Suspense,{fallback:s.a.createElement("div",null)},s.a.createElement("div",{className:"appContainer"},s.a.createElement(m.a,null,s.a.createElement(d.c,null,s.a.createElement(d.a,{exact:!0,path:"/configtab",component:g}),s.a.createElement(d.a,{exact:!0,path:"/messages",component:Oe}),s.a.createElement(d.a,{exact:!0,path:"/newmessage",component:Ge}),s.a.createElement(d.a,{exact:!0,path:"/newmessage/:id",component:Ge}),s.a.createElement(d.a,{exact:!0,path:"/viewstatus/:id",component:He}),s.a.createElement(d.a,{exact:!0,path:"/sendconfirmation/:id",component:Ve}),s.a.createElement(d.a,{exact:!0,path:"/errorpage",component:Je}),s.a.createElement(d.a,{exact:!0,path:"/errorpage/:id",component:Je}),s.a.createElement(d.a,{exact:!0,path:"/signin",component:$e}),s.a.createElement(d.a,{exact:!0,path:"/signin-simple-start",component:Ke}),s.a.createElement(d.a,{exact:!0,path:"/signin-simple-end",component:Ye}))))))},r.state={theme:"",themeStyle:Te.ThemeStyle.Light},r}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;p.initialize(),p.getContext((function(t){var a=t.theme||"";e.updateTheme(a),e.setState({theme:a})})),p.registerOnThemeChangeHandler((function(t){e.updateTheme(t),e.setState({theme:t},(function(){e.forceUpdate()}))})),function(){var e=window.location.search,t=new URLSearchParams(e).get("locale")||"en-US";z.a.changeLanguage(t),A.a.locale(t)}()}},{key:"render",value:function(){return s.a.createElement("div",null,this.setThemeComponent())}}]),a}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var et=a(128),tt=Object(et.c)({messagesList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return"FETCH_MESSAGES"===t.type?t.payload:e},draftMessagesList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return"FETCH_DRAFTMESSAGES"===t.type?t.payload:e},selectedMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return"MESSAGE_SELECTED"===t.type?t.payload:e}}),at=a(419),nt=Object(et.d)(tt,Object(et.a)(at.a));i.a.render(s.a.createElement(E.a,{store:nt},s.a.createElement(Ze,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[427,1,2]]]);
//# sourceMappingURL=main.6d6afc51.chunk.js.map